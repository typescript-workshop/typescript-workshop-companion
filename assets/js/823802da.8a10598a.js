"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[259],{4261:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"atelier/filtrer-des-lignes","title":"Exercice 6","description":"\xcatre capable de s\xe9lectionner des lignes, c\'est bien, mais pouvoir les filtrer \xe7a serait canon, qu\'en pensez-vous ?","source":"@site/docs/atelier/6-filtrer-des-lignes.md","sourceDirName":"atelier","slug":"/atelier/filtrer-des-lignes","permalink":"/typescript-workshop-companion/docs/atelier/filtrer-des-lignes","draft":false,"unlisted":false,"editUrl":"https://github.com/typescript-workshop/typescript-workshop-companion/tree/main/packages/create-docusaurus/templates/shared/docs/atelier/6-filtrer-des-lignes.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Exercice 5","permalink":"/typescript-workshop-companion/docs/atelier/selectionner-tous-les-champs"},"next":{"title":"Exercice 7","permalink":"/typescript-workshop-companion/docs/atelier/supprimer-des-lignes"}}');var s=i(4848),r=i(8453);const o={sidebar_position:6},l="Exercice 6",c={},d=[{value:"Indice 1",id:"indice-1",level:2},{value:"Indice 2",id:"indice-2",level:2},{value:"Indice 3",id:"indice-3",level:2},{value:"Solution",id:"solution",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"exercice-6",children:"Exercice 6"})}),"\n",(0,s.jsx)(n.p,{children:"\xcatre capable de s\xe9lectionner des lignes, c'est bien, mais pouvoir les filtrer \xe7a serait canon, qu'en pensez-vous ?"}),"\n",(0,s.jsxs)(n.p,{children:["C'est partit, impl\xe9mentons une clause ",(0,s.jsx)(n.code,{children:"where"})," ! L'objectif de cet exercice est d'\xe0 partir du typage actuel de le faire \xe9voluer afin de pouvoir filtrer en fonction de crit\xe8res d\xe9finis.\nPar exemple dans les tests, nous nous amuserons \xe0 filtrer sur la date de naissance ou encore le pr\xe9nom des utilisateurs."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"where autocomplete",src:i(7619).A+"",width:"1800",height:"196"})}),"\n",(0,s.jsxs)(n.p,{children:["Rendez-vous dans le fichier ",(0,s.jsx)(n.code,{children:"6-filtrer-des-lignes.ts"})," et ",(0,s.jsx)(n.code,{children:"db.ts"})," pour l'impl\xe9mentation."]}),"\n",(0,s.jsx)(n.p,{children:"\xc0 vous de jouer !"}),"\n",(0,s.jsx)(n.admonition,{title:"Ressources",type:"tip",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/typescript-workshop-companion/docs/typescript/keyof-lookup",children:"KeyOf & lookup"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/typescript-workshop-companion/docs/typescript/conditional-types",children:"Types conditionnels"})}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"indice-1",children:"Indice 1"}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Tout est l\xe0"}),(0,s.jsxs)(n.p,{children:["La signature de ",(0,s.jsx)(n.code,{children:"where"})," d\xe9pend du type du contexte (en l'occurrence de ",(0,s.jsx)(n.em,{children:"s\xe9lection"})," dans une ",(0,s.jsx)(n.em,{children:"table"})," d'une base de donn\xe9e arbitraire) ainsi que du nom et du type de champ (qu'on peut d\xe9duire de la ",(0,s.jsx)(n.em,{children:"table"}),") sur lequel le filtre sera appliqu\xe9."]})]}),"\n",(0,s.jsx)(n.h2,{id:"indice-2",children:"Indice 2"}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Faisons simple"}),(0,s.jsxs)(n.p,{children:["Pour le moment, nous n'impl\xe9mentons qu'une clause d'\xe9galit\xe9, un type litt\xe9ral devrait faire l'affaire pour l'argument ",(0,s.jsx)(n.code,{children:"operator"})," !"]})]}),"\n",(0,s.jsx)(n.h2,{id:"indice-3",children:"Indice 3"}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Panachage"}),(0,s.jsxs)(n.p,{children:["Au final, on va utiliser ici beaucoup de choses qu'on a d\xe9j\xe0 pu aborder : ",(0,s.jsx)(n.em,{children:"lookup types"}),", mots-cl\xe9 ",(0,s.jsx)(n.em,{children:"keyof"})," ou ",(0,s.jsx)(n.em,{children:"extends"}),"."]})]}),"\n",(0,s.jsx)(n.h2,{id:"solution",children:"Solution"}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Avant de d\xe9plier pour afficher la solution, n'h\xe9sitez pas \xe0 nous solliciter ! "}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'\n  type FilterableContext<DB> = SelectableContext<DB> & {\n    _fields: (keyof DB[keyof DB])[] | "ALL";\n  };\n\n  type AnyFilterableContext = FilterableContext<any>;\n\n  export const where = <\n    Ctx extends AnySelectableContext,\n    Field extends keyof Ctx["$db"][Ctx["_table"]]\n  >(\n    ctx: Ctx,\n    field: Field,\n    operator: "=",\n    value: Ctx["$db"][Ctx["_table"]][Field]\n  ) => ({\n    ...ctx,\n    _where: {\n      field,\n      operator,\n      value,\n    },\n  });\n'})})]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},7619:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/where_autocomplete-e512e03eafe26e4b804091f26e3306b7.png"},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var t=i(6540);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);